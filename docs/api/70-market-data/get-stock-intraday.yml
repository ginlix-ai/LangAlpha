info:
  name: Get Stock Intraday
  type: http
  seq: 1

http:
  method: GET
  url: "{{base_url}}/api/v1/market-data/intraday/stocks/{{symbol}}?interval={{intraday_interval}}"
  params:
    - name: interval
      value: "{{intraday_interval}}"
      type: query
  auth: inherit

runtime:
  variables:
    - name: intraday_interval
      value: 5min

settings:
  encodeUrl: true
  timeout: 0

docs: |
  ## Get Stock Intraday Data

  Retrieve intraday OHLCV data for a single stock symbol.

  ### Path Parameters
  - `symbol` (required): Stock ticker symbol (e.g., AAPL, MSFT, GOOGL)

  ### Query Parameters
  - `interval`: Data interval - one of: 1min, 5min, 15min, 30min, 1hour, 4hour (default: 1min)
  - `from`: Start date in YYYY-MM-DD format (optional)
  - `to`: End date in YYYY-MM-DD format (optional)

  ### Response Fields
  - `symbol`: Stock ticker symbol
  - `interval`: Data interval used
  - `data`: Array of OHLCV data points
    - `date`: Timestamp in ISO format
    - `open`: Opening price
    - `high`: High price
    - `low`: Low price
    - `close`: Closing price
    - `volume`: Trading volume
  - `count`: Number of data points returned
  - `cache`: Cache metadata
    - `cached`: Whether data was served from cache
    - `cache_key`: Cache key used
    - `ttl_remaining`: Remaining TTL in seconds
    - `refreshed_in_background`: Whether a background refresh was triggered

  ### Error Responses
  - 422: Invalid interval for stocks
  - 500: Failed to fetch data

tests:
  test1: |
    test("should return 200", function() {
      expect(res.status).to.equal(200);
    });
  test2: |
    test("should return symbol", function() {
      expect(res.body.symbol).to.be.a("string");
    });
  test3: |
    test("should return interval", function() {
      expect(res.body.interval).to.be.a("string");
    });
  test4: |
    test("should return data array", function() {
      expect(res.body.data).to.be.an("array");
    });
  test5: |
    test("should return count", function() {
      expect(res.body.count).to.be.a("number");
    });
  test6: |
    test("should return cache metadata", function() {
      expect(res.body.cache).to.be.an("object");
      expect(res.body.cache.cached).to.be.a("boolean");
    });
